# ========== Образ контейнера ==========
image:
  repository: "cr.yandex/crp8o64j2cl644b4pjki/imshaby-api"
  tag: "latest"
  pullPolicy: IfNotPresent

imagePullSecrets:
  - name: yandex-cr-secret

# ========== Namespace ==========
namespace: "backend"

# ========== Реплики и стратегия развертывания ==========
replicaCount: 1

strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 25%
    maxUnavailable: 0

# ========== Сервис ==========
service:
  enabled: true
  type: ClusterIP
  port: 80
  targetPort: 8080

# ========== Ingress ==========
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
  hosts:
    - host: "api.imsha.by"
      paths:
        - path: /
          pathType: Prefix
  tls: []

# ========== Конфигурация приложения ==========
config:
  env: "production"
  logLevel: "info"

secrets:
  enabled: false
  existingSecret: ""

# ========== Ресурсы и лимиты ==========
resources:
  requests:
    memory: "640Mi"
    cpu: "250m"
  limits:
    memory: "1000Mi"
    cpu: "500m"

# ========== Health Checks ==========
livenessProbe: []

readinessProbe: []

startupProbe: []

# ========== Безопасность ==========
securityContext:
  pod:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
  container:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL
    seccompProfile:
      type: RuntimeDefault

# ========== ServiceAccount ==========
serviceAccount:
  create: false
  name: ""
  annotations: {}

# ========== Autoscaling ==========
autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

# ========== Толеранции и affinity ==========
nodeSelector: {}
tolerations: []
affinity: {}

# ========== Дополнительные volume mounts ==========
volumes: []

volumeMounts: []

# ========== Дополнительные containers (sidecars) ==========
sidecars: []

# ========== Init containers ==========
initContainers: []

# ========== Метки и аннотации ==========
labels: {}
annotations: {}
podLabels: {}
podAnnotations: {}

# ========== Дополнительные параметры ==========
extraEnv: []
extraEnvFrom: []

# ========== Multiple workloads (optional) ==========
# When present and non-empty, the chart renders one Deployment/Service/Ingress/ConfigMap per entry.
# Each key is the workload name (e.g. api, worker). Omit or leave empty for legacy single-deployment mode.
# See docs: specs/003-multi-deploy-namespace/contracts/helm-values-workloads.md
workloads:
  multisearch:
    image:
      repository: "cr.yandex/crp8o64j2cl644b4pjki/imshaby-mass-index-creator-prod"
      tag: latest
    replicaCount: 1
    service:
      enabled: true
      port: 80
      targetPort: 7700
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
