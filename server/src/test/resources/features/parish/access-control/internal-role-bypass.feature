#language: ru
#encoding: UTF-8
#noinspection NonAsciiCharacters

Функционал: REST-API приложения imshaby-api. Контроль доступа к парафиям - Обход для ROLE_INTERNAL

  Как пользователь с ROLE_INTERNAL,
  Я хочу иметь доступ ко всем парафиям без ограничений

  Предыстория:
    Допустим для авторизации используется внутренний api-токен

  Сценарий: Создание парафии с ROLE_INTERNAL успешно без проверки прав
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ТестПарафия_ROLE_INTERNAL"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Тогда код ответа равен 201
    И полученное поле "Наименование" заполнено значением "ТестПарафия_ROLE_INTERNAL"

  Сценарий: Обновление парафии с ROLE_INTERNAL успешно без проверки прав
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_parish_internal_id"
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ОригинальноеИмя"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Когда подготавливаем запрос Изменение парафии
    И с переменными
      | идентификатор | [ключ] test_parish_internal_id |
    И поле "Наименование" заполнено значением "ОбновлённоеИмя"
    Затем выполняем запрос

    Тогда код ответа равен 200
    И полученное поле "Статус" заполнено значением "UPDATED"

  Сценарий: Удаление парафии с ROLE_INTERNAL успешно без проверки прав
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_parish_delete_internal_id"
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ПарафияДляУдаления"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Когда подготавливаем запрос Удаление парафии
    И с переменными
      | идентификатор | [ключ] test_parish_delete_internal_id |
    Затем выполняем запрос

    Тогда код ответа равен 200
    И полученное поле "Статус" заполнено значением "DELETED"
