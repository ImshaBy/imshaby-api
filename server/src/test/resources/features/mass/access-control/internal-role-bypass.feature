#language: ru
#encoding: UTF-8
#noinspection NonAsciiCharacters

Функционал: REST-API приложения imshaby-api. Контроль доступа к мессам - Обход для ROLE_INTERNAL

  Как пользователь с ROLE_INTERNAL,
  Я хочу иметь доступ ко всем мессам без ограничений по парафиям

  Предыстория:
    Допустим для авторизации используется внутренний api-токен

  Сценарий: Создание мессы с ROLE_INTERNAL успешно без проверки прав к парафии
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_mass_parish_internal_id"
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ПарафияДляМессы"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Когда подготавливаем запрос Создание Служб
    И поле "Идентификатор парафии" заполнено значением "[ключ] test_mass_parish_internal_id"
    И поле "Время Служб" заполнено значением "10:00"
    И поле "Дни Служб" заполнено значением "[0,1,2,3,4,5,6]"
    Затем выполняем запрос

    Тогда код ответа равен 201
    И полученное поле "Идентификатор парафии" заполнено значением "[ключ] test_mass_parish_internal_id"

  Сценарий: Обновление мессы с ROLE_INTERNAL успешно без проверки прав к парафии
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_mass_update_parish_id"
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ПарафияДляОбновленияМессы"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Когда подготавливаем запрос Создание Служб
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_mass_update_id"
    И поле "Идентификатор парафии" заполнено значением "[ключ] test_mass_update_parish_id"
    И поле "Время Служб" заполнено значением "10:00"
    И поле "Дни Служб" заполнено значением "[0,1,2,3,4,5,6]"
    Затем выполняем запрос

    Когда подготавливаем запрос Обновление Служб
    И с переменными
      | идентификатор | [ключ] test_mass_update_id |
    И поле "Идентификатор парафии" заполнено значением "[ключ] test_mass_update_parish_id"
    И поле "Время Служб" заполнено значением "18:00"
    И поле "Дни Служб" заполнено значением "[6]"
    Затем выполняем запрос

    Тогда код ответа равен 200
    И полученное поле "Статус" заполнено значением "UPDATED"

  Сценарий: Удаление мессы с ROLE_INTERNAL успешно без проверки прав к парафии
    Когда подготавливаем запрос Создание парафии
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_mass_delete_parish_id"
    И поле "Статус" заполнено значением "PENDING"
    И поле "Наименование" заполнено значением "ПарафияДляУдаленияМессы"
    И поле "Ключ" заполнено уникальным значением
    И поле "Идентификатор города" заполнено уникальным значением
    Затем выполняем запрос

    Когда подготавливаем запрос Создание Служб
    И поле "Идентификатор" заполнено уникальным значением и сохранено с ключом "test_mass_delete_id"
    И поле "Идентификатор парафии" заполнено значением "[ключ] test_mass_delete_parish_id"
    И поле "Время Служб" заполнено значением "10:00"
    И поле "Дни Служб" заполнено значением "[0,1,2,3,4,5,6]"
    Затем выполняем запрос

    Когда подготавливаем запрос Удаление Служб
    И с переменными
      | идентификатор | [ключ] test_mass_delete_id |
    Затем выполняем запрос

    Тогда код ответа равен 200
    И полученное поле "Статус" заполнено значением "DELETED"
